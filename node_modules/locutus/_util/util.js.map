{"version":3,"sources":["../../src/_util/util.js"],"names":["globby","require","path","fs","async","YAML","mkdirp","debug","indentString","_","esprima","Util","argv","__src","dirname","__dirname","__root","__test","globals","pattern","concurrency","authorKeys","langDefaults","c","order","function_title_template","human","packageType","inspiration_urls","function_description_template","golang","python","ruby","php","alias","allowSkip","indexOf","_reindexBuffer","_injectwebBuffer","cb","self","_runFunctionOnAll","_injectwebOne","err","indexHtml","writeFileSync","_reindexOne","indexJs","requires","sort","join","_writetestOne","runFunc","q","queue","fullpath","callback","_load","bind","params","files","sync","push","drain","filepath","dir","basefile","basename","module","line","authors","forEach","key","headKeys","flattenDeep","langPath","language","langIndexPath","catPath","category","catIndexPath","funcPath","func_name","langTitle","langData","Object","assign","warning","type","layout","title","safeDump","trim","catTitle","catData","functionTitle","replace","functionDescription","funcData","examples","example","map","lines","i","returns","dependencies","notes","note","description","function","permalink","buf","code","then","writeFile","Error","name","relativeSrcForTest","JSON","stringify","subdir","testpath","testdir","relativeSrcForTestDir","relative","relativeTestFileForRoot","testProps","test","describeSkip","codez","global","_addRequire","length","humanIndex","parseInt","itSkip","body","testExpected","j","fileOrName","requesterParams","substr","msg","readFile","_opener","_parse","depCodePath","loaded","_findDependencies","parts","split","shift","codepath","pop","ast","parseScript","comment","loc","range","moduleExports","filter","leftArg","node","expression","left","rightArg","right","object","property","id","exp","funcName","funcParams","p","funcLoc","firstFuncBodyElementLoc","headComments","comments","start","end","value","_headKeys","func_arguments","headLines","keys","match","dmatch","val","num","exports"],"mappings":"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","file":"util.js","sourcesContent":["const globby = require('globby')\nconst path = require('path')\nconst fs = require('fs')\nconst async = require('async')\nconst YAML = require('js-yaml')\nconst mkdirp = require('mkdirp')\nconst debug = require('depurar')('locutus')\nconst indentString = require('indent-string')\nconst _ = require('lodash')\nconst esprima = require('esprima')\n\nclass Util {\n  constructor (argv) {\n    if (!argv) {\n      argv = []\n    }\n    this.__src = path.dirname(__dirname)\n    this.__root = path.dirname(path.dirname(__dirname))\n    this.__test = path.dirname(path.dirname(__dirname)) + '/test'\n\n    this.globals = {}\n\n    this.pattern = [this.__src + '/**/**/*.js', '!**/index.js', '!**/_util/**']\n    this.concurrency = 8\n    this.authorKeys = [\n      'original by',\n      'improved by',\n      'reimplemented by',\n      'parts by',\n      'bugfixed by',\n      'revised by',\n      'input by'\n    ]\n\n    this.langDefaults = {\n      c: {\n        order: 1,\n        function_title_template: '[language]\\'s [category].[function] in JavaScript',\n        human: 'C',\n        packageType: 'header file',\n        inspiration_urls: [\n          '<a href=\"https://en.cppreference.com/w/c/numeric/math\">the C math.h documentation</a>',\n          '<a href=\"https://sourceware.org/git/?p=glibc.git;a=tree;f=math;hb=HEAD\">the C math.h source</a>'\n        ],\n        function_description_template: 'Here’s what our current JavaScript equivalent to <a href=\"https://en.cppreference.com/w/c/numeric/[category]/[function]\">[language]\\'s [function] found in the [category].h header file</a> looks like.'\n      },\n      golang: {\n        order: 2,\n        function_title_template: '[language]\\'s [category].[function] in JavaScript',\n        human: 'Go',\n        packageType: 'package',\n        inspiration_urls: [\n          '<a href=\"https://golang.org/pkg/strings/\">Go strings documentation</a>',\n          '<a href=\"https://golang.org/src/strings/strings.go\">Go strings source</a>',\n          '<a href=\"https://golang.org/src/strings/example_test.go\">Go strings examples source</a>',\n          '<a href=\"https://gophersjs.com\">GopherJS</a>'\n        ],\n        function_description_template: 'Here’s what our current JavaScript equivalent to <a href=\"https://golang.org/pkg/[category]/#[function]\">[language]\\'s [category].[function]</a> looks like.'\n      },\n      python: {\n        order: 3,\n        function_title_template: '[language]\\'s [category].[function] in JavaScript',\n        human: 'Python',\n        packageType: 'module',\n        inspiration_urls: [\n          '<a href=\"https://docs.python.org/3/library/string.html\">the Python 3 standard library string page</a>'\n        ],\n        function_description_template: 'Here’s what our current JavaScript equivalent to <a href=\"https://docs.python.org/3/library/[category].html#[category].[function]\">[language]\\'s [category].[function]</a> looks like.'\n      },\n      ruby: {\n        order: 4,\n        function_title_template: '[language]\\'s [category].[function] in JavaScript',\n        human: 'Ruby',\n        packageType: 'module',\n        inspiration_urls: [\n          '<a href=\"https://ruby-doc.org/core-2.2.2/Math.html\">the Ruby core documentation</a>'\n        ],\n        function_description_template: 'Here’s what our current JavaScript equivalent to <a href=\"https://ruby-doc.org/core-2.2.2/[category].html#method-c-[function]\">[language]\\'s [category].[function]</a> looks like.'\n      },\n      php: {\n        order: 5,\n        function_title_template: '[language]\\'s [function] in JavaScript',\n        human: 'PHP',\n        packageType: 'extension',\n        inspiration_urls: [\n          '<a href=\"https://php.net/manual/en/book.strings.php\">the PHP string documentation</a>',\n          '<a href=\"https://github.com/php/php-src/blob/master/ext/standard/string.c#L5338\">the PHP string source</a>',\n          '<a href=\"https://github.com/php/php-src/blob/master/ext/standard/tests/strings/str_pad_variation1.phpt\">a PHP str_pad test</a>'\n        ],\n        function_description_template: 'Here’s what our current JavaScript equivalent to <a href=\"https://php.net/manual/en/function.[functiondashed].php\">[language]\\'s [function]</a> looks like.',\n        alias: [\n          '/categories/',\n          '/categories/array/',\n          '/categories/bc/',\n          '/categories/ctype/',\n          '/categories/datetime/',\n          '/categories/exec/',\n          '/categories/filesystem/',\n          '/categories/funchand/',\n          '/categories/i18n/',\n          '/categories/index/',\n          '/categories/info/',\n          '/categories/json/',\n          '/categories/math/',\n          '/categories/misc/',\n          '/categories/net/',\n          '/categories/network/',\n          '/categories/pcre/',\n          '/categories/strings/',\n          '/categories/url/',\n          '/categories/var/',\n          '/categories/xdiff/',\n          '/categories/xml/',\n          '/functions/index/',\n          '/functions/',\n          '/packages/',\n          '/packages/index/'\n        ]\n      }\n    }\n\n    this.allowSkip = (argv.indexOf('--noskip') === -1)\n\n    this._reindexBuffer = {}\n    this._injectwebBuffer = {}\n  }\n\n  injectweb (cb) {\n    const self = this\n    this._runFunctionOnAll(this._injectwebOne, function (err) {\n      if (err) {\n        return cb(err)\n      }\n      for (const indexHtml in self._injectwebBuffer) {\n        debug('writing: ' + indexHtml)\n        fs.writeFileSync(indexHtml, self._injectwebBuffer[indexHtml], 'utf-8')\n      }\n    })\n  }\n\n  reindex (cb) {\n    const self = this\n    self._reindexBuffer = {}\n    self._runFunctionOnAll(self._reindexOne, function (err) {\n      if (err) {\n        return cb(err)\n      }\n      for (const indexJs in self._reindexBuffer) {\n        const requires = self._reindexBuffer[indexJs]\n        requires.sort()\n        debug('writing: ' + indexJs)\n        fs.writeFileSync(indexJs, requires.join('\\n') + '\\n', 'utf-8')\n      }\n    })\n  }\n\n  writetests (cb) {\n    this._runFunctionOnAll(this._writetestOne, cb)\n  }\n\n  _runFunctionOnAll (runFunc, cb) {\n    const self = this\n\n    const q = async.queue(function (fullpath, callback) {\n      self._load.bind(self, fullpath, {}, function (err, params) {\n        if (err) {\n          return callback(err)\n        }\n\n        runFunc.bind(self, params, callback)()\n      })()\n    }, self.concurrency)\n\n    debug({\n      pattern: self.pattern\n    })\n    const files = globby.sync(self.pattern)\n\n    q.push(files)\n\n    q.drain = cb\n  }\n\n  _reindexOne (params, cb) {\n    const fullpath = this.__src + '/' + params.filepath\n    const dir = path.dirname(fullpath)\n    const basefile = path.basename(fullpath, '.js')\n    const indexJs = dir + '/index.js'\n\n    let module = basefile\n    if (basefile === 'Index2') {\n      module = 'Index'\n    }\n\n    if (!this._reindexBuffer[indexJs]) {\n      this._reindexBuffer[indexJs] = []\n    }\n\n    const line = 'module.exports.' + module + ' = require(\\'./' + basefile + '\\')'\n    this._reindexBuffer[indexJs].push(line)\n    return cb(null)\n  }\n\n  _injectwebOne (params, cb) {\n    const authors = {}\n    this.authorKeys.forEach(function (key) {\n      if (params.headKeys[key]) {\n        authors[key] = _.flattenDeep(params.headKeys[key])\n      }\n    })\n\n    const langPath = [\n      this.__root,\n      '/website/source/',\n      params.language\n    ].join('')\n\n    const langIndexPath = langPath + '/index.html'\n    const catPath = langPath + '/' + params.category\n    const catIndexPath = catPath + '/' + 'index.html'\n    const funcPath = catPath + '/' + params.func_name + '.html'\n\n    if (!this._injectwebBuffer[langIndexPath]) {\n      let langTitle = ''\n      langTitle += this.langDefaults[params.language].human + ' '\n      langTitle += this.langDefaults[params.language].packageType + 's '\n      langTitle += ' in JavaScript'\n\n      const langData = Object.assign({}, this.langDefaults[params.language], {\n        warning: 'This file is auto generated by `npm run web:inject`, do not edit by hand',\n        type: 'language',\n        layout: 'language',\n        language: params.language,\n        title: langTitle\n      })\n      this._injectwebBuffer[langIndexPath] = '---' + '\\n' + YAML.safeDump(langData).trim() + '\\n' + '---' + '\\n'\n    }\n\n    if (!this._injectwebBuffer[catIndexPath]) {\n      let catTitle = ''\n      catTitle += this.langDefaults[params.language].human + '\\'s '\n      catTitle += params.category + ' '\n      catTitle += this.langDefaults[params.language].packageType + ' '\n      catTitle += ' in JavaScript'\n\n      const catData = {\n        warning: 'This file is auto generated by `npm run web:inject`, do not edit by hand',\n        type: 'category',\n        layout: 'category',\n        language: params.language,\n        category: params.category,\n        title: catTitle\n      }\n      this._injectwebBuffer[catIndexPath] = '---' + '\\n' + YAML.safeDump(catData).trim() + '\\n' + '---' + '\\n'\n    }\n\n    const functionTitle = this.langDefaults[params.language].function_title_template\n      .replace(/\\[language]/g, this.langDefaults[params.language].human)\n      .replace(/\\[category]/g, params.category)\n      .replace(/\\[function]/g, params.func_name)\n      .replace(/\\[functiondashed]/g, params.func_name.replace(/_/g, '-'))\n\n    const functionDescription = this.langDefaults[params.language].function_description_template\n      .replace(/\\[language]/g, this.langDefaults[params.language].human)\n      .replace(/\\[category]/g, params.category)\n      .replace(/\\[function]/g, params.func_name)\n      .replace(/\\[functiondashed]/g, params.func_name.replace(/_/g, '-'))\n\n    const funcData = {\n      warning: 'This file is auto generated by `npm run web:inject`, do not edit by hand',\n      examples: (params.headKeys.example || []).map(function (lines, i) {\n        return lines.join('\\n')\n      }),\n      returns: (params.headKeys.returns || []).map(function (lines, i) {\n        return lines.join('\\n')\n      }),\n      dependencies: [],\n      authors: authors || {},\n      notes: (params.headKeys.note || []).map(function (lines, i) {\n        return lines.join('\\n')\n      }),\n      type: 'function',\n      layout: 'function',\n      title: functionTitle,\n      description: functionDescription,\n      function: params.func_name,\n      category: params.category,\n      language: params.language,\n      permalink: params.language + '/' + params.category + '/' + params.func_name + '/',\n      alias: [\n        '/functions/' + params.language + '/' + params.func_name + '/',\n        '/functions/' + params.category + '/' + params.func_name + '/',\n        '/' + params.language + '/' + params.func_name + '/'\n      ]\n    }\n\n    if (params.language === 'php') {\n      funcData.alias.push('/functions/' + params.func_name + '/')\n    }\n\n    let buf = '---' + '\\n' + YAML.safeDump(funcData).trim() + '\\n' + '---' + '\\n'\n\n    buf += `{% codeblock lang:javascript %}${params.code}{% endcodeblock %}`\n\n    mkdirp(path.dirname(funcPath)).then(function () {\n      fs.writeFile(funcPath, buf, 'utf-8', cb)\n    }, function (err) {\n      throw new Error('Could not mkdir  for ' + funcPath + '. ' + err)\n    })\n  }\n\n  _addRequire (name, relativeSrcForTest) {\n    return [\n      'var ',\n      name,\n      ' = require(\\'',\n      relativeSrcForTest,\n      '\\') // eslint-disable-line no-unused-vars,camelcase'\n    ].join('')\n  }\n\n  _writetestOne (params, cb) {\n    const self = this\n\n    if (!params.func_name) {\n      throw new Error('No func_name in ' + JSON.stringify(params))\n    }\n    if (!params.headKeys) {\n      throw new Error('No headKeys in ' + params.func_name)\n    }\n    if (!params.headKeys.example) {\n      throw new Error('No example in ' + params.func_name)\n    }\n\n    const basename = path.basename(params.filepath)\n    const subdir = path.dirname(params.filepath)\n    const testpath = this.__test + '/languages/' + subdir + '/test-' + basename\n    const testdir = path.dirname(testpath)\n    const relativeSrcForTestDir = path.relative(testdir, self.__src)\n    const relativeTestFileForRoot = path.relative(self.__root, testpath)\n\n    // console.log(relativeSrcForTestDir)\n    // process.exit(1)\n\n    let testProps = ''\n    if (params.headKeys.test) {\n      testProps = params.headKeys.test[0][0]\n    }\n\n    let describeSkip = ''\n    if (self.allowSkip && testProps.indexOf('skip-all') !== -1) {\n      describeSkip = '.skip'\n    }\n\n    const codez = []\n\n    codez.push('// warning: This file is auto generated by `npm run build:tests`')\n    codez.push('// Do not edit by hand!')\n\n    // Add globals\n    for (const global in self.globals) {\n      codez.push('var ' + global + ' = ' + self.globals[global])\n    }\n\n    // Set timezone for testing dates\n    // Not ideal: https://stackoverflow.com/questions/8083410/how-to-set-default-timezone-in-node-js\n    codez.push('process.env.TZ = \\'UTC\\'')\n\n    codez.push('var ' + 'expect' + ' = require(\\'chai\\').expect')\n\n    // Add language-wide dependencies\n    // @todo: It would be great if we could remove this\n    if (params.language === 'php') {\n      codez.push(self._addRequire('ini_set', relativeSrcForTestDir + '/' + 'php/info/ini_set'))\n      codez.push(self._addRequire('ini_get', relativeSrcForTestDir + '/' + 'php/info/ini_get'))\n      if (params.func_name === 'localeconv') {\n        codez.push(self._addRequire(\n          'setlocale',\n          relativeSrcForTestDir + '/' + 'php/strings/setlocale'\n        ))\n      }\n      if (params.func_name === 'i18n_loc_get_default') {\n        codez.push(self._addRequire(\n          'i18n_loc_set_default',\n          relativeSrcForTestDir + '/' + 'php/i18n/i18n_loc_set_default'\n        ))\n      }\n    }\n\n    // Add the main function to test\n    codez.push(self._addRequire(\n      params.func_name,\n      relativeSrcForTestDir + '/' + params.filepath\n    ))\n\n    codez.push('')\n\n    codez.push([\n      'describe',\n      describeSkip,\n      '(\\'src/',\n      params.filepath,\n      ' (tested in ',\n      relativeTestFileForRoot,\n      ')\\', function () {'\n    ].join(''))\n\n    // Run each example\n    for (const i in params.headKeys.example) {\n      if (!params.headKeys.returns[i] || !params.headKeys.returns[i].length) {\n        throw new Error('There is no return for example ' + i, test, params)\n      }\n\n      const humanIndex = parseInt(i, 10) + 1\n      let itSkip = ''\n      if (self.allowSkip && testProps.indexOf('skip-' + humanIndex) !== -1) {\n        itSkip = '.skip'\n      }\n\n      codez.push([\n        '  it',\n        itSkip,\n        '(\\'should pass example ',\n        (humanIndex),\n        '\\', function (done) {'\n      ].join(''))\n\n      const body = []\n\n      const testExpected = params.headKeys.returns[i].join('\\n')\n\n      body.push('var expected = ' + testExpected)\n\n      // Execute line by line (see date.js why)\n      // We need result be the last result of the example code\n      for (const j in params.headKeys.example[i]) {\n        if (parseInt(j, 10) === params.headKeys.example[i].length - 1) {\n          // last action gets saved\n          body.push('var result = ' + params.headKeys.example[i][j].replace('var $result = ', ''))\n        } else {\n          body.push(params.headKeys.example[i][j])\n        }\n      }\n\n      body.push('expect(result).to.deep.equal(expected)')\n      body.push('done()')\n\n      codez.push(indentString(body.join('\\n'), ' ', 4))\n\n      codez.push('  })')\n    }\n\n    codez.push('})')\n    codez.push('')\n\n    const code = codez.join('\\n')\n\n    // Write to disk\n    mkdirp(testdir).then(function () {\n      debug('writing: ' + testpath)\n      fs.writeFile(testpath, code, 'utf-8', cb)\n    }, function (err) {\n      throw new Error(err)\n    })\n  }\n\n  // Environment-specific file opener. function name needs to\n  // be translated to code. The difficulty is in finding the\n  // category.\n  _opener (fileOrName, requesterParams, cb) {\n    const self = this\n    let pattern\n\n    const language = requesterParams.language || '*'\n\n    if (path.basename(fileOrName, '.js').indexOf('.') !== -1) {\n      // periods in the basename, like: unicode.utf8.RuneCountInString or strings.sprintf\n      pattern = self.__src + '/' + language + '/' + fileOrName.replace(/\\./g, '/') + '.js'\n    } else if (fileOrName.indexOf('/') === -1) {\n      // no slashes, like: sprintf\n      pattern = self.__src + '/' + language + '/*/' + fileOrName + '.js'\n    } else if (fileOrName.substr(0, 1) === '/') {\n      // absolute path, like: /Users/john/code/locutus/php/strings/sprintf.js\n      pattern = fileOrName\n    } else {\n      // relative path, like: php/strings/sprintf.js\n      pattern = self.__src + '/' + fileOrName\n    }\n\n    pattern = pattern.replace('golang/strings/Index.js', 'golang/strings/Index2.js')\n    debug('loading: ' + pattern)\n    const files = globby.sync(pattern, {})\n\n    if (files.length !== 1) {\n      const msg = `Found ${files.length} occurances of ${fileOrName} via pattern: ${pattern}`\n      return cb(new Error(msg))\n    }\n\n    const filepath = files[0]\n\n    if (path.basename(filepath) === 'index.js') {\n      return cb(null)\n    }\n\n    if (!filepath) {\n      return cb(new Error('Could not find ' + pattern))\n    }\n\n    fs.readFile(filepath, 'utf-8', function (err, code) {\n      if (err) {\n        return cb(new Error('Error while opening ' + filepath + '. ' + err))\n      }\n      return cb(null, filepath, code)\n    })\n  }\n\n  _load (fileOrName, requesterParams, cb) {\n    const self = this\n    self._opener(fileOrName, requesterParams, function (err, fullpath, code) {\n      if (err) {\n        return cb(err)\n      }\n\n      const filepath = path.relative(self.__src, fullpath)\n      self._parse(filepath, code, cb)\n    })\n  }\n\n  _findDependencies (fileOrName, requesterParams, dependencies, cb) {\n    const self = this\n\n    if (!requesterParams.headKeys['depends on'] || !requesterParams.headKeys['depends on'].length) {\n      if (cb) {\n        cb(null, {})\n      }\n      return\n    }\n\n    let i\n    let depCodePath\n    let loaded = 0\n    for (i in requesterParams.headKeys['depends on']) {\n      depCodePath = requesterParams.headKeys['depends on'][i][0]\n\n      self._load(depCodePath, requesterParams, function (err, params) {\n        if (err) {\n          return cb(err)\n        }\n\n        dependencies[depCodePath] = params\n        self._findDependencies(depCodePath, params, dependencies)\n\n        if (cb && ++loaded === requesterParams.headKeys['depends on'].length) {\n          cb(null, dependencies)\n        }\n      })\n    }\n  }\n\n  _parse (filepath, code, cb) {\n    if (!code) {\n      return cb(new Error('Unable to parse ' + filepath + '. Received no code'))\n    }\n\n    if (filepath.indexOf('/') === -1) {\n      return cb(new Error('Parse only accepts relative filepaths. Received: \\'' + filepath + '\\''))\n    }\n\n    const parts = filepath.split('/')\n    const language = parts.shift()\n    const codepath = parts.join('.')\n    const name = parts.pop()\n    const category = parts.join('.')\n\n    const ast = esprima.parseScript(code, { comment: true, loc: true, range: true })\n\n    // find module.exports in the code\n    const moduleExports = ast.body.filter(node => {\n      try {\n        const leftArg = node.expression.left\n        const rightArg = node.expression.right\n\n        return leftArg.object.name === 'module' &&\n            leftArg.property.name === 'exports' &&\n            rightArg.type === 'FunctionExpression' &&\n            rightArg.id.type === 'Identifier' &&\n            !!rightArg.id.name\n      } catch (err) {\n        return false\n      }\n    })\n\n    // if file contains more than one export, fail\n    if (moduleExports.length !== 1) {\n      return cb(Error(`File ${filepath} is allowed to contain exactly one module.exports`))\n    }\n\n    // get the only export\n    const exp = moduleExports[0]\n\n    // look for function name and param list\n    const funcName = exp.expression.right.id.name\n    const funcParams = exp.expression.right.params.map(p => p.name)\n\n    // remember the lines where the function is defined\n    const funcLoc = exp.expression.right.loc\n\n    // since comments are not included in the AST\n    // but are offered in ast.comments\n    // remember the location of first function body statement/expression\n    const firstFuncBodyElementLoc = exp.expression.right.body.body[0].loc\n\n    // get all line comments which are located between function signature definition\n    // and first function body element\n    const headComments = ast.comments.filter(c =>\n      c.type === 'Line' &&\n      c.loc.start.line >= funcLoc.start.line &&\n      c.loc.end.line <= firstFuncBodyElementLoc.start.line).map(c => c.value.trim())\n\n    if (headComments.length === 0) {\n      const msg = `Unable to parse ${filepath}. Did not find any comments in function definition`\n      return cb(new Error(msg))\n    }\n\n    const headKeys = this._headKeys(headComments)\n\n    const params = {\n      headKeys: headKeys,\n      name: name,\n      filepath: filepath,\n      codepath: codepath,\n      code: code,\n      language: language,\n      category: category,\n      func_name: funcName,\n      func_arguments: funcParams\n    }\n\n    this._findDependencies(filepath, params, {}, function (err, dependencies) {\n      if (err) {\n        return cb(err)\n      }\n\n      params.dependencies = dependencies\n      return cb(null, params)\n    })\n  }\n\n  _headKeys (headLines) {\n    let i\n    const keys = {}\n    let match = []\n    let dmatch = []\n    let key = ''\n    let val = ''\n    let num = 0\n\n    for (i in headLines) {\n      if (!(match = headLines[i].match(/^\\s*\\W?\\s*([a-z 0-9]+)\\s*:\\s*(.*)\\s*$/))) {\n        continue\n      }\n      key = match[1]\n      val = match[2]\n\n      if ((dmatch = key.match(/^(\\w+)\\s+(\\d+)$/))) {\n        // Things like examples and notes can be grouped\n        key = dmatch[1]\n        num = dmatch[2] - 1\n      } else {\n        num = 0\n      }\n\n      if (!keys[key]) {\n        keys[key] = []\n      }\n      if (!keys[key][num]) {\n        keys[key][num] = []\n      }\n      keys[key][num].push(val)\n    }\n\n    return keys\n  }\n}\n\nmodule.exports = Util\n"]}